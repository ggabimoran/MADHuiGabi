knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(reshape2)
set.seed(3)
K<-3
p<-50
n<-200
pi<-c(1/3,1/3,1/3)
M<-matrix(runif(K*p),K,p)
M[K,]<-1-M[1,]
?rmultinom
nks<-rmultinom(1,200,prob = pi)
Z<-rep(1:length(nks),nks)
Z
nks
X <-do.call(rbind,
mapply(function(nk,k){
matrix(rbernoulli(nk*p,p=M[k,]),
nrow = nk,
ncol=p,
byrow = TRUE)}, nks,1:K))
ggplot(melt(X), aes(x = Var2, y = Var1)) +
geom_raster(aes(fill=value)) +
scale_fill_brewer(aesthetics = "fill") +
labs(x="Variables", y="Individus", title="Matrix")
sample(10)
permutation <- sample(nrow(X))
X <- X[permutation,]
ggplot(melt(X), aes(x = Var2, y = Var1)) +
geom_raster(aes(fill=value)) +
scale_fill_brewer(aesthetics = "fill") +
labs(x="Variables", y="Individus", title="Matrix")
ggplot(melt(X), aes(x = Var2, y = Var1)) +
geom_raster(aes(fill=value)) +
scale_fill_brewer(aesthetics = "fill") +
labs(x="Variables", y="Individus", title="Matrix")
kmeans(X,3,nstart = 10)->res.kmeans
100*res.kmeans$tot.withinss/res.kmeans$totss
tidyData<-melt(X[order(res.kmeans$cluster),order(M[1,])])
ggplot(tidyData, aes(x = Var2, y = Var1)) +
geom_raster(aes(fill=value)) +
scale_fill_brewer(aesthetics = "fill") +
labs(x="Variables", y="Individus", title="Matrix")
attributes(res.kmeans)
res.kmeans$size
nks
res.kmeans$iter
?kmeans
